    <!DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Eco Map: Explore our Trees in Bukidnon</title>

        <!-- Leaflet  -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
            integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

        <!-- Make sure you put this AFTER Leaflet's CSS -->
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

        <!-- Bootstrap 5.3.8 -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
            crossorigin="anonymous"></script>

        <link rel="stylesheet" href="style.css">

        <style>
            /* Scrollable left panel tree list */
            .tree-list {
                max-height: 700px;
                /* controls how tall the list is */
                overflow-y: auto;
                /* enables vertical scrolling */
            }

            /* Optional: smoother scrollbar (Chrome/Edge) */
            .tree-list::-webkit-scrollbar {
                width: 8px;
            }

            .tree-list::-webkit-scrollbar-thumb {
                background-color: #2E7D32;
                border-radius: 4px;
            }

            .tree-list::-webkit-scrollbar-track {
                background: #f1f1f1;
            }


            .native-label {
                color: green;
                font-weight: bold;
            }

            .endemic-label {
                color: orange;
                font-weight: bold;
            }
        </style>
    </head>

    <body>

        <header class="main-header">
            <img src="ecomapLogo.png" alt="Eco Map Logo" class="logo">
            <h1>Eco Map</h1>
        </header>

        <div class="container-fluid mt-2">
            <div class="row">

                <!-- LEFT PANEL: SEARCH + TREE LIST -->
                <div class="col-12 col-md-3">

                    <!-- Search Bar -->
                    <div class="mb-3">
                        <input type="text" id="searchBar" class="form-control" placeholder="Search tree name...">
                    </div>

                    <!-- Tree List -->
                    <div class="card">
                        <ul class="list-group tree-list" id="treeList">

                        </ul>
                    </div>
                </div>

                <!-- RIGHT PANEL NGA MAP -->
                <div class="col-12 col-md-9">
                    <div id="map"></div>
                </div>
            </div>
        </div>

        <script>
            function initMap(mapDataUrl) {

                // Custom Eco Marker Icon
                const ecoMarkerIcon = L.divIcon({
                    className: "eco-marker",
                    html: `
        <svg width="40" height="55" viewBox="0 0 120 160" xmlns="http://www.w3.org/2000/svg">
        <path d="M60 5 C30 5 10 30 10 60 C10 95 60 155 60 155 C60 155 110 95 110 60 C110 30 90 5 60 5 Z" fill="#2E7D32"/>
        <circle cx="60" cy="55" r="35" fill="white"/>
        <path d="M60 30 C50 30 45 40 50 45 C42 45 40 55 48 58 C45 65 52 70 60 66 C68 70 75 65 72 58 C80 55 78 45 70 45 C75 40 70 30 60 30 Z" fill="#2E7D32"/>
        <rect x="57" y="66" width="6" height="14" fill="#2E7D32"/>
        </svg>
        `,
                    iconSize: [40, 55],
                    iconAnchor: [20, 55],
                    popupAnchor: [0, -50]
                });


                const map = L.map('map').setView([8.2, 125.1], 9);

                const openStreetMap = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    maxZoom: 19,
                    attribution: '&copy; OpenStreetMap contributors'
                }).addTo(map);

                const satellite = L.tileLayer(
                    'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
                    { attribution: 'Tiles Â© Esri | Maxar | Earthstar Geographics' }
                );

                let markers = [];
                let treeData = [];

                const treeList = document.getElementById("treeList");
                const searchBar = document.getElementById("searchBar");

                fetch(mapDataUrl)
                    .then(res => res.json())
                    .then(data => {

                        data.forEach(pin => {

                            // Create marker
                            const marker = L.marker(
                                [pin.lat, pin.lng],
                                { icon: ecoMarkerIcon }
                            ).addTo(map);

                            const img = `<img src='${pin.img}' class="popup-image">`;

                            marker.bindPopup(`
                            ${img}<br>
                            <b>${pin.title}</b><br>
                            ${pin.scientific}<br>
                            <b>Description:</b> ${pin.description}<br>
                            <b>Medicinal Uses:</b> ${pin.medicinal}<br>
                            <i>${pin.category}</i>
                        `);

                            // Auto-pan popup to center
                            marker.on("click", () => {
                                map.setView([pin.lat, pin.lng], 14, { animate: true });

                                setTimeout(() => {
                                    const popup = marker.getPopup();
                                    const popupHeight = popup._container.offsetHeight;

                                    map.panBy([0, -(popupHeight / 2)], {
                                        animate: true,
                                        duration: 0.3
                                    });
                                }, 200);
                            });

                            // Add marker to memory
                            markers.push({ title: pin.title.toLowerCase(), marker, pin });

                            // Add to Sidebar List
                            const li = document.createElement("li");
                            li.classList.add("list-group-item");
                            li.innerHTML = `<strong>${pin.title}</strong> <br><small>${pin.category}</small>`;

                            li.onclick = () => {
                                map.setView([pin.lat, pin.lng], 14);
                                marker.openPopup();
                            };

                            treeList.appendChild(li);

                        });

                        // Layer Control
                        L.control.layers(
                            { "OpenStreetMap": openStreetMap, "Satellite": satellite },
                            {},
                            { collapsed: false }
                        ).addTo(map);

                    });

                // Search Function
                searchBar.addEventListener("keyup", function () {
                    const text = this.value.toLowerCase().trim();
                    treeList.innerHTML = "";

                    markers.forEach(obj => {

                        if (obj.title.includes(text)) {
                            const li = document.createElement("li");
                            li.classList.add("list-group-item");
                            li.innerHTML = `<strong>${obj.pin.title}</strong><br><small>${obj.pin.category}</small>`;

                            li.onclick = () => {
                                map.setView([obj.pin.lat, obj.pin.lng], 14);
                                obj.marker.openPopup();
                            };

                            treeList.appendChild(li);
                        }
                    });

                });
            }

            document.addEventListener("DOMContentLoaded", function () {
                initMap("eco-map.json");
            });


        </script>
    </body>

    </html>